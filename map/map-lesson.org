#+PROPERTY: header-args :tangle no
* Map Operations
** Outline
*** Lesson Objectives
*** Intro - loop patterns
*** Manual Mapping I Do
*** Manual Mapping More Complex Example We Do
** Introduction: Loop Patterns

We've written a /lot/ of loops in this course so far. You're gaining practice and mastery with them, to the point where you might have started to recognize /patterns/ in all these loops.

Some of the types of loops you've encountered are:

1. Loops that hit every even or odd value, or every 3rd or 4th, skipping over some.
2. Loops that check each value against a condition, acting differently with different kinds of values.
3. Loops that transform each value in the array in some way, like doubling each number, getting the initials of each name, or extracting a property from each object.
4. Loops that look at the value before or after the current one, combining values in myriad ways.
5. Loops that loop through a series of values to give you one value, like an average of numbers, or how often each word appears in a sentence.

In the world of production apps, some of these types of loops appear over and over again. Others don't come up very often at all, but make for good learning exercises.

Today we're going to look at one particular type of loop that you find all the time in real-world apps: the map operation (number 3 in the preceding list).

We'll take a look at the mapping operation by deconstructing and generalizing mapping loops, so we can understand the /how/ and the /why/ of using them.

** Manual Mapping - Looking At Some Examples
*** A simple example
#+begin_src js
const people = ["Colin", "Kerridene", "Tim"];
const attendanceChecks = [];
for (let i = 0; i < people.length; i++) {
  attendanceChecks.push(`Is ${people[i]} here today?`)
}

console.log(attendanceChecks)
#+end_src

#+RESULTS:
: [
:   'Is Colin here today?',
:   'Is Kerridene here today?',
:   'Is Tim here today?'
: ]

*** Another Common Example
Here's an example using numbers:

#+begin_src js
const grades = [90, 85, 53, 76];
const curvedGrades = [];
for (let i = 0; i < grades.length; i++) {
  curvedGrades.push(grades[i] + 10);
}

console.log(curvedGrades);
#+end_src

#+RESULTS:
: [ 100, 95, 63, 86 ]

*** Let's Do One Together

We'll have to do a little more work this time!

#+begin_src js
const grades = [90, 85, 53, 76];
const passFailGrades = [];
for (let i = 0; i < grades.length; i++) {
  let passFailGrade = "Fail";
  if (grades[i] >= 60) {
    passFailGrade = "Pass";
  }

  passFailGrades.push(passFailGrade);
}

console.log(passFailGrades);
#+end_src

#+RESULTS:
: [ 'Pass', 'Pass', 'Fail', 'Pass' ]

*** Question: what is the pattern here?

*** So What Is A Map Operation
Breaking it down, in a map operation, we return a /new/ array where we've transformed the original values into new ones. In this case, the transformation went from a person's first name to a sentence containing the first name.

Doing it in a loop looks like this:

1. Create an empty array.
2. Loop through the old array.
3. Transform the value (in this case, from a simple name string into a sentence)
4. Push that value into the new array.

Mapping operations are /extremely/ common in engineering. Let's look at some examples!

#+ATTR_ORG: :width 600
[[./twitter-feed.png]]

#+ATTR_ORG: :width 600
[[./netflix.jpg]]

#+ATTR_ORG: :width 600
[[./meta.png]]


** Manual Mapping - We Do Exercise
#+NAME: people-2
#+begin_src js
const people = [
  {
    name: {
      first: 'Kerridene',
      last: 'Waters'
    },

    age: 28,
    isAwesome: true,
    isModest: true,
    hobbies: ['Biking', 'Horticulture', 'Woodworking']
  },
  {
    name: {
      first: 'Colin',
      last: 'Jaffe'
    },

    age: 42,
    isAwesome: true,
    isModest: false,
    hobbies: ['Emacs', 'Board Games', 'Writing']
  },
  {
    name: {
      first: 'Tim',
      last: 'Calhoun'
    },

    age: Infinity,
    isAwesome: true,
    isModest: true,
    hobbies: ['Skiing', 'Hiking', 'Taking Names']
  },
]
#+end_src

#+NAME: bios
#+begin_src js
const bios = []
for (let i = 0; i < people.length; i++) {
  const fullName = people[i].name.first + ' ' + people[i].name.last;
  const hobbies = people[i].hobbies.join(' and ')
  bios.push(`${fullName} is ${people[i].age} years old and loves ${hobbies}.`)
}
#+end_src

#+begin_src js
<<people-2>>
<<bios>>
console.log(bios);
#+end_src

#+RESULTS:
: [
:   'Kerridene Waters is 28 years old and loves Biking and Horticulture and Woodworking.',
:   'Colin Jaffe is 42 years old and loves Emacs and Board Games and Writing.',
:   'Tim Calhoun is Infinity years old and loves Skiing and Hiking and Taking Names.'
: ]

** Nitter

#+NAME: tweets
#+begin_src js
const tweets = [
  {
    username: 'dril',
    text: 'Update from the good time lineâ€”Bacion is legal to eat at work thanks to President Banksy in the whitehouse, now known as the star wars house',
    displayName: 'wint',
    postId: 2,
    likes: 3999,
    replies: 137
  },
  {
    username: 'Leemanish',
    displayName: 'blake',
    text: 'Sick of having to go to 2 different huts to buy pizza & sunglasses.',
    postId: 3,
    likes: 4736,
    replies: 15
  },
  {
    username: 'queer_queenie',
    displayName: 'Queenie',
    text: `i hold a gender reveal party. all my relatives wait as i pull off the cake cover. the icing says "gender is a spectrum". it's too late, i have the powerpoint up`,
    postId: 4,
    likes: 8349,
    replies: 132
  },
  {
    username: 'phranqueigh',
    displayName: 'Frankie Zelnick',
    text: "How dare you call me mentally unstable, on this, the day of my cat's quinceanera.",
    postId: 5,
    likes: 3612,
    replies: 16
  }
];

console.log(tweets)
#+end_src

#+RESULTS: tweets
#+begin_example
[
  {
    username: 'dril',
    text: 'Update from the good time lineâ€”Bacion is legal to eat at work thanks to President Banksy in the whitehouse, now known as the star wars house',
    displayName: 'wint',
    postId: 2,
    likes: 3999,
    replies: 137
  },
  {
    username: 'Leemanish',
    displayName: 'blake',
    text: 'Sick of having to go to 2 different huts to buy pizza & sunglasses.',
    postId: 3,
    likes: 4736,
    replies: 15
  },
  {
    username: 'queer_queenie',
    displayName: 'Queenie',
    text: `i hold a gender reveal party. all my relatives wait as i pull off the cake cover. the icing says "gender is a spectrum". it's too late, i have the powerpoint up`,
    postId: 4,
    likes: 8349,
    replies: 132
  },
  {
    username: 'phranqueigh',
    displayName: 'Frankie Zelnick',
    text: "How dare you call me mentally unstable, on this, the day of my cat's quinceanera.",
    postId: 5,
    likes: 3612,
    replies: 16
  }
]
#+end_example

#+NAME: convertNumber
#+begin_src js
const convertNumber = (number) => {
  if (number < 1000) {
    return number.toString();
  }

  return (Math.floor(number / 100) / 10).toString() + 'K'
}
#+end_src

#+NAME: getDisplayTweets
#+begin_src js
const getDisplayTweets = (tweet) => (`${tweet.displayName}
@${tweet.username}

${tweet.text}

${tweet.likes} Likes   ${tweet.replies} Replies`)
#+end_src

#+NAME: getDisplayTweetsColor
#+begin_src js
<<convertNumber>>

const getDisplayTweets = (tweet) => (`${tweet.displayName.blue}
@${tweet.username}

${tweet.text}

ðŸ’™ ${convertNumber(tweet.likes).bold}  ðŸ—¨ ${convertNumber(tweet.replies).bold}  ðŸ”— Copy Link`)
#+end_src

#+RESULTS: getDisplayTweetsColor

#+begin_src js
<<tweets>>
<<getDisplayTweets>>
const tweet = getDisplayTweets(tweets[0]);
console.log(tweet);
#+end_src

#+RESULTS:
: wint
: @dril
: 
: Update from the good time lineâ€”Bacion is legal to eat at work thanks to President Banksy in the whitehouse, now known as the star wars house
: 
: 2139 Likes   NaN Replies


#+begin_src js 
<<tweets>>

const tweetStrings = [];
for (let i = 0; i < tweets.length; i++) {
  const tweet = tweets[i];
  const tweetString = `${tweet.displayName}
@${tweet.username}

${tweet.text}

${tweet.retweets} Retweets   ${tweet.likes} Likes   ${tweet.replies} Replies`
  tweetStrings.push(tweetString);
}

tweetStrings.forEach((tweetString) => console.log(tweetString + '\n\n'))
#+end_src

#+RESULTS:
#+begin_example
wint
@dril

Update from the good time lineâ€”Bacion is legal to eat at work thanks to President Banksy in the whitehouse, now known as the star wars house

1200 Retweets   8200 Likes   28 Replies


blake
@Leemanish

Sick of having to go to 2 different huts to buy pizza & sunglasses.

2900 Retweets   6300 Likes   210 Replies


Queenie
@queer_queenie

i hold a gender reveal party. all my relatives wait as i pull off the cake cover. the icing says "gender is a spectrum". it's too late, i have the powerpoint up

16900 Retweets   70600 Likes   730 Replies


Frankie Zelnick
@phranqueigh

How dare you call me mentally unstable, on this, the day of my cat's quinceanera.

5000 Retweets   9300 Likes   121 Replies


#+end_example

This is a library we'll pull in to allow us to make our terminal output prettier. We'll be using it exclusively to get bold text in our tweets.

#+NAME: imports
#+begin_src js
const colors = require('colors');
#+end_src

Now we can di
#+begin_src js :tangle nitter.js
<<imports>>

<<tweets>>

<<getDisplayTweetsColor>>

const displayTweets = tweets.map(getDisplayTweets);
displayTweets.forEach((displayTweet) => console.log(displayTweet + '\n'));
#+end_src

#+RESULTS:
